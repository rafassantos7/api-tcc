spring.application.name=LevelUp-API

# --- CONFIGURAÇÕES DO BANCO DE DADOS ---
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/db_levelup}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:1234}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# --- CORREÇÃO PARA ERRO SUPABASE ---
spring.datasource.hikari.data-source-properties.prepareThreshold=0
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# --- CONFIGURAÇÕES HIKARI CP (OTIMIZADO PARA PRODUÇÃO) ---
# Pool generoso - Supabase free tier aguenta até 60-100 conexões
spring.datasource.hikari.maximum-pool-size=50
# Mínimo de conexões sempre ativas
spring.datasource.hikari.minimum-idle=10
# Reduzido para 20s - não espera 30s por conexão
spring.datasource.hikari.connection-timeout=20000
# Tempo que conexão fica idle antes de ser fechada (5min)
spring.datasource.hikari.idle-timeout=300000
# Tempo máximo de vida da conexão (20min)
spring.datasource.hikari.max-lifetime=1200000
# Teste de conexão antes de usar (importante para Supabase)
spring.datasource.hikari.connection-test-query=SELECT 1
# Validação automática de conexões idle
spring.datasource.hikari.validation-timeout=5000

# --- HIBERNATE (OTIMIZADO) ---
spring.jpa.hibernate.ddl-auto=update
# DESLIGADO em produção - melhora performance
spring.jpa.show-sql=false
# Formatar SQL desligado - economiza processamento
spring.jpa.properties.hibernate.format_sql=false
# Batch processing - melhora inserts/updates em massa
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
# Cache de segundo nível (opcional, mas ajuda)
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true

# --- SEGURANÇA JWT ---
api.security.token.secret=${JWT_SECRET:MinhaSenhaSecretaDeDesenvolvimento123}

# --- CORS ---
api.security.cors.origins=${CORS_ORIGINS:*}

# --- LOGGING (Reduzido para produção) ---
logging.level.root=WARN
logging.level.org.springframework.web=WARN
logging.level.org.hibernate=WARN
# Só loga sua aplicação em INFO
logging.level.com.levelup=INFO
